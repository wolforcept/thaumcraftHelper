<!DOCTYPE html>
<html lang="">

<head>
    <meta charset="utf-8">
    <title>Thaumcraft Helper</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Karla:ital,wght@0,200..800;1,200..800&display=swap');

        body {
            background-color: #222223;
            font-family: "Karla", sans-serif;
            font-optical-sizing: auto;
            font-weight: 200;
            font-style: normal;
        }
    </style>
    <!-- <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, initial-scale=1.0; user-scalable=0;"> -->
    <!-- <link rel="manifest" href="/manifest.json"> -->
    <!-- <link rel="stylesheet" href="style.css"> -->

    <!-- JQuery -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <!-- JQuery UI -->
    <script src="https://code.jquery.com/ui/1.13.3/jquery-ui.min.js" integrity="sha256-sw0iNNXmOJbQhYFuC9OF2kOlD5KQKe1y5lfBn4C9Sjg=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/ui-darkness/jquery-ui.css">
    <!-- P5 JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.4/p5.min.js" integrity="sha512-d6sc8kbZEtA2LwB9m/ck0FhvyUwVfdmvTeyJRprmj7Wg9wRFtHDIpr6qk4g/y3Ix3O9I6KHIv6SGu9f7RaP1Gw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!-- Semantic UI -->
    <!-- GET THEMES HERE: https://semantic-ui-forest.com/themes/ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.5.0/semantic.min.js" integrity="sha512-Xo0Jh8MsOn72LGV8kU5LsclG7SUzJsWGhXbWcYs2MAmChkQzwiW/yTQwdJ8w6UA9C6EVG18GHb/TrYpYCjyAQw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.5.0/semantic.min.css" integrity="sha512-KXol4x3sVoO+8ZsWPFI/r5KBVB/ssCGB5tsv2nVOKwLg33wTFP3fmnXa47FdSVIshVTgsYk/1734xSk9aFIa4A==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <link rel="stylesheet" href="semantic.superhero.min.css" />

    <style>
        .ui.button.element {
            width: 200px;
            margin: 0;
        }

        .ui.button.element img {
            width: 32px;
        }

        .ui.button.element .name {
            width: 100px;
            display: inline-block;
            transform: translateY(-10px);
        }

        .ui.button.element .path {
            position: absolute;
            background-color: inherit;
            color: white;
            padding: 10px;
            left: 0;
            width: 100%;
            /* top: 100%; */
            z-index: 1;
            opacity: 0;
        }

        .ui.button.element:hover .path.exists {
            opacity: 1;
        }

        .ui.button.element.range1 {
            background-color: rgb(161, 73, 70);
        }

        .ui.button.element.range2 {
            background-color: rgb(216, 163, 83);
        }

        .ui.button.element.range3 {
            background-color: rgb(127, 189, 47);
        }

        .ui.button.element.selected {
            background-color: rgb(11, 228, 228);
        }

        .ui.table {
            background-color: #00000000;
        }
    </style>
</head>

<body>
    <div class="ui inverted menu" style="background-color: #485563;">
        <div class="ui container">
            <div class="header item">
                <img class="logo" src="./logo.png" style="margin-right: 20px;">
                Thaumcraft Element Path Helper
            </div>
        </div>
    </div>


    <div class="ui container">
        <table id="buttonGrid"></table>
        <p id="path" style="margin: 1px 0 0 3px; width: 812px; background-color: #485563;min-height: 40px;"></p>
    </div>

    <script async defer>

        const elements = {
            Aer: { meaning: "air", components: [] },
            Alienis: { meaning: "eldritch", components: ["Tenebrae", "Vacuos"] },
            Aqua: { meaning: "water", components: [] },
            Arbor: { meaning: "tree", components: ["Aer", "Herba"] },
            Auram: { meaning: "aura", components: ["Aer", "Praecantatio"] },
            Bestia: { meaning: "animal", components: ["Motus", "Victus"] },
            Cognitio: { meaning: "mind", components: ["Ignis", "Spiritus"] },
            Corpus: { meaning: "flesh", components: ["Bestia", "Mortuus"] },
            Exanimis: { meaning: "undead", components: ["Motus", "Mortuus"] },
            Fabrico: { meaning: "craft, repair", components: ["Humanus", "Instrumentum"] },
            Fames: { meaning: "hunger", components: ["Vacuos", "Victus"] },
            Gelum: { meaning: "cold, ice", components: ["Ignis", "Perditio"] },
            Herba: { meaning: "plant", components: ["Terra", "Victus"] },
            Humanus: { meaning: "human", components: ["Bestia", "Cognitio"] },
            Ignis: { meaning: "fire", components: [] },
            Instrumentum: { meaning: "tool", components: ["Humanus", "Ordo"] },
            Iter: { meaning: "travel", components: ["Motus", "Terra"] },
            Limus: { meaning: "slime", components: ["Aqua", "Victus"] },
            Lucrum: { meaning: "greed, wealth", components: ["Fames", "Humanus"] },
            Lux: { meaning: "light", components: ["Aer", "Ignis"] },
            Machina: { meaning: "machine, device", components: ["Instrumentum", "Motus"] },
            Messis: { meaning: "crop", components: ["Herba", "Humanus"] },
            Metallum: { meaning: "metal", components: ["Terra", "Vitreus"] },
            Meto: { meaning: "harvest", components: ["Instrumentum", "Messis"] },
            Mortuus: { meaning: "death", components: ["Perditio", "Victus"] },
            Motus: { meaning: "motion", components: ["Aer", "Ordo"] },
            Ordo: { meaning: "order", components: [] },
            Pannus: { meaning: "cloth", components: ["Bestia", "Instrumentum"] },
            Perditio: { meaning: "chaos", components: [] },
            Perfodio: { meaning: "mining", components: ["Humanus", "Terra"] },
            Permutatio: { meaning: "exchange", components: ["Ordo", "Perditio"] },
            Potentia: { meaning: "energy", components: ["Ignis", "Ordo"] },
            Praecantatio: { meaning: "magic", components: ["Potentia", "Vacuos"] },
            Sano: { meaning: "healing", components: ["Ordo", "Victus"] },
            Sensus: { meaning: "senses", components: ["Aer", "Spiritus"] },
            Spiritus: { meaning: "soul", components: ["Mortuus", "Victus"] },
            Telum: { meaning: "weapon", components: ["Ignis", "Instrumentum"] },
            Tempestas: { meaning: "weather", components: ["Aer", "Aqua"] },
            Tenebrae: { meaning: "darkness", components: ["Lux", "Vacuos"] },
            Terra: { meaning: "earth, ground", components: [] },
            Tutamen: { meaning: "armor", components: ["Instrumentum", "Terra"] },
            Vacuos: { meaning: "void", components: ["Aer", "Perditio"] },
            Venenum: { meaning: "poison", components: ["Aqua", "Perditio"] },
            Victus: { meaning: "life", components: ["Aqua", "Terra"] },
            Vinculum: { meaning: "trap", components: ["Motus", "Perditio"] },
            Vitium: { meaning: "taint", components: ["Perditio", "Praecantatio"] },
            Vitreus: { meaning: "crystal", components: ["Ordo", "Terra"] },
            Volatus: { meaning: "flight", components: ["Aer", "Motus"] },
        };

        function lightSubElements(element1id, range, path) {

            const element1 = elements[element1id];
            const part1 = element1.components[0];
            const part2 = element1.components[1];
            const button1 = element1.button;

            Object.keys(elements).forEach(element2id => {

                const element2 = elements[element2id];
                const button2 = element2.button;
                const subpart1 = element2.components[0];
                const subpart2 = element2.components[1];

                if ((
                    (element2id === part1 || element2id === part2) ||
                    (subpart1 === element1id || subpart2 === element1id)
                )
                ) {
                    const newPath = [...path, element2id];
                    if (element2.path.length === 0 || newPath.length < element2.path.length) {
                        button2.addClass("range" + range);
                        element2.path = newPath
                        if (range > -3) lightSubElements(element2id, range - 1, newPath);
                    }
                }
            });
        }

        function makeButton(elementId) {
            const button = $(`
            <button class="ui button element">
                <img src="./imgs/${elementId.toLowerCase()}.png">
                <span class="name">${elementId}</span>
            </button>`);
            button.on('click', () => {

                Object.keys(elements).forEach(e => {
                    elements[e].path = [];
                    elements[e].button.removeClass("selected");
                    elements[e].button.removeClass("range3");
                    elements[e].button.removeClass("range2");
                    elements[e].button.removeClass("range1");
                });
                button.addClass("selected");
                lightSubElements(elementId, 3, [elementId]);
            });
            elements[elementId].button = button;
            button.on("mouseenter", () => {
                if (elements[elementId].path.length === 0) return;
                const pathDiv = $('#path');
                pathDiv.empty();
                elements[elementId].path.forEach((element, index) => {
                    pathDiv.append($(`
                    <div class="ui label" style="margin-right:10px; background-color:transparent">
                        <img src="./imgs/${element.toLowerCase()}.png"  style="margin-right:10px;">
                        <span class="name">${element}</span>
                    </div>`));
                    if (index < elements[elementId].path.length - 1)
                        pathDiv.append($(`<i class="right chevron icon divider" style="transform:translateY(2px)"></i>`));
                });
            });
            return button;
        }

        const body = $(`<tbody></tbody>`);
        let i = 0;
        let row = $(`<tr></tr>`);
        Object.keys(elements).forEach(elementId => {
            const button = makeButton(elementId);

            const cell = $(`<td></td>`);
            cell.append(button);
            row.append(cell);

            i++;
            if (i % 4 === 0) {
                body.append(row);
                row = $(`<tr></tr>`);
            }
        });
        $('#buttonGrid').append(body);
    </script>

</body>

</html>